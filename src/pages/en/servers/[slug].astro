---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { getTranslation } from "../../../utils/i18n";
import servers from "../../../data/servers.json";

// Definimos el tipo para locale explícitamente
type Locale = 'es' | 'en';

// Generar rutas dinámicas para cada servidor en inglés
export function getStaticPaths() {
  return servers.map(server => ({
    params: { slug: server.slug },
    props: { server }
  }));
}

// Obtener propiedades
const { server } = Astro.props;

// Establecer locale a inglés explícitamente
const locale: Locale = 'en';

// Traducir según el idioma
const t = (key: string) => getTranslation(key, locale);

// Título y descripción para SEO
const title = `${server.name} | LuminaKraft Studios`;
const description = t(server.descriptionKey);

// Determinar los colores específicos del servidor
let primaryColor = "#4a90e2"; // Color predeterminado
let secondaryColor = "#1a2735"; // Color secundario predeterminado

// Colores específicos por servidor
if (server.id === "onepieceworld") {
  primaryColor = "#ffb400";
  secondaryColor = "#1a2735";
} else if (server.id === "ancientkraft") {
  primaryColor = "#c0a080";
  secondaryColor = "#2a1f1f";
} else if (server.id === "pt-the_full_course") {
  primaryColor = "#ff5252";
  secondaryColor = "#2a2a2a";
}

// Definir video de YouTube si existe
const youtubeEmbed = {
  "onepieceworld": "https://www.youtube.com/embed/mHat204bZog",
  "ancientkraft": "https://www.youtube.com/embed/SsBTE69AE8I",
  "pt-the_full_course": ""
}[server.id] || "";

// Características específicas por servidor
const serverFeatures = {
  "onepieceworld": [
    { icon: "fa-apple-whole", title: "Frutas del Diablo", description: "Consume poderosas frutas que te otorgarán habilidades especiales, ¡pero cuidado con el mar!" },
    { icon: "fa-fist-raised", title: "Combate con Haki y Estilos de Lucha", description: "Domina Haki, artes marciales y estilos de combate inspirados en personajes como Sanji o Zoro." },
    { icon: "fa-ship", title: "Explora el Grand Line", description: "Navega por islas legendarias, descubre tesoros y enfréntate a peligrosos piratas y marines." },
    { icon: "fa-users", title: "Aventuras Multijugador", description: "Únete a una tripulación, enfréntate a otros jugadores, o forma alianzas para dominar los mares." }
  ],
  "ancientkraft": [
    { icon: "fa-magic", title: "Sistema de Magia Personalizado", description: "Domina hechizos únicos y aprovecha el poder de los elementos" },
    { icon: "fa-fist-raised", title: "Combate Mejorado", description: "Experimenta batallas emocionantes con mecánicas y habilidades mejoradas" },
    { icon: "fa-map-marked-alt", title: "Vasto Mundo para Explorar", description: "Descubre ruinas antiguas, tesoros ocultos y mazmorras desafiantes" },
    { icon: "fa-users", title: "Aventuras Multijugador", description: "Forma equipo con amigos o únete a una facción para conquistar el mundo juntos" }
  ],
  "pt-the_full_course": [
    { icon: "fa-compass", title: "Exploración", description: "Descubre un mundo lleno de secretos y sorpresas por descubrir" },
    { icon: "fa-users", title: "Comunidad", description: "Únete a una comunidad amigable y colaborativa de jugadores" },
    { icon: "fa-puzzle-piece", title: "Plugins personalizados", description: "Disfruta de plugins exclusivos que mejoran la experiencia de juego" },
    { icon: "fa-calendar-alt", title: "Eventos regulares", description: "Participa en eventos especiales y competiciones organizadas por el staff" }
  ]
}[server.id] || [];
---

<BaseLayout title={title} description={description} locale={locale}>
  <!-- Estilos específicos del servidor -->
  <style define:vars={{ primaryColor, secondaryColor }}>
    .text-primary {
      color: var(--primaryColor);
    }
    .bg-primary {
      background-color: var(--primaryColor);
    }
    .hover\:bg-primary:hover {
      background-color: var(--primaryColor);
    }
    .from-primary {
      --tw-gradient-from: var(--primaryColor);
    }
    .to-primary {
      --tw-gradient-to: var(--primaryColor);
    }
    .border-primary {
      border-color: var(--primaryColor);
    }
    .shadow-glow {
      box-shadow: 0 0 15px rgba(var(--primaryColor), 0.5);
    }
    .bg-secondary {
      background-color: var(--secondaryColor);
    }
  </style>

  <!-- Aviso de servidor cerrado si aplica -->
  {!server.isActive && (
    <div class="fixed top-[60px] left-0 right-0 z-50 bg-red-500/80 text-white py-1 px-4 text-center font-medium text-sm flex items-center justify-center gap-2">
      <i class="fas fa-circle-exclamation"></i>
      <span>{t('server-closed-notice')}</span>
    </div>
  )}

  <div class="pt-24 pb-16 px-4">
    <div class="container mx-auto max-w-6xl">
      <!-- Cabecera del servidor -->
      <div class="flex flex-col items-center text-center mb-12 animate-fade-up">
        <div class="w-48 h-48 md:w-64 md:h-64 lg:w-80 lg:h-80 flex items-center justify-center mb-6">
          <img 
            src={server.logo || server.images[0]} 
            alt={`${server.name} Logo`}
            class="scale-125 max-w-full max-h-full object-contain"
            loading="eager"
          />
        </div>
        <div>
          <div class="flex items-center justify-center flex-wrap gap-3 mb-2">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-primary">{server.name}</h1>
            {server.isNew && (
              <span class="bg-primary/90 text-white px-3 py-1 rounded-full text-sm font-bold animate-pulse">
                NEW
              </span>
            )}
          </div>
          <p class="text-white/90 text-lg md:text-xl max-w-2xl mx-auto mb-6">{t(server.descriptionKey)}</p>
          <div class="flex flex-wrap items-center justify-center gap-3">
            <span class="px-3 py-1 bg-black/30 backdrop-blur-sm rounded-full text-sm border border-primary/30">
              {server.gamemode}
            </span>
            <span class="px-3 py-1 bg-black/30 backdrop-blur-sm rounded-full text-sm border border-primary/30">
              {server.modloader}
            </span>
            {server.versions.map((version) => (
              <span class="px-3 py-1 bg-black/30 backdrop-blur-sm rounded-full text-sm border border-primary/30">
                {version}
              </span>
            ))}
          </div>
        </div>
      </div>

      <!-- Características del servidor -->
      {serverFeatures.length > 0 && (
        <div class="mb-12 animate-fade-up">
          <h2 class="text-2xl font-bold text-primary mb-6">{t('features-title')}</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {serverFeatures.map(feature => (
              <div class="bg-black/30 backdrop-blur-sm p-6 rounded-lg text-center hover:transform hover:scale-105 transition-all hover:shadow-lg border border-primary/10 hover:border-primary/30">
                <i class={`fas ${feature.icon} text-4xl text-primary mb-4`}></i>
                <h3 class="text-xl font-bold text-primary mb-2">{t(`server-feature-${server.id}-${serverFeatures.indexOf(feature) + 1}-title`)}</h3>
                <p class="text-white/80">{t(`server-feature-${server.id}-${serverFeatures.indexOf(feature) + 1}-desc`)}</p>
              </div>
            ))}
          </div>
        </div>
      )}

      <!-- Tráiler del servidor si existe -->
      {youtubeEmbed && (
        <div class="mb-12 animate-fade-up">
          <h2 class="text-2xl font-bold text-primary mb-6">{t('trailers-title')} {server.name}</h2>
          <div class="relative overflow-hidden pt-[56.25%] rounded-lg border border-primary/20">
            <iframe 
              class="absolute top-0 left-0 w-full h-full border-0"
              src={youtubeEmbed}
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
              allowfullscreen
              loading="lazy"
            ></iframe>
          </div>
        </div>
      )}

      <!-- Imágenes del servidor -->
      <div class="mb-12 animate-fade-up animate-delay-200">
        <h2 class="text-2xl font-bold text-primary mb-6">{t('screenshots-title')}</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          {server.images.map((image, index) => (
            <div class="overflow-hidden rounded-lg border border-primary/20">
              <img 
                src={image} 
                alt={`${server.name} Screenshot ${index + 1}`}
                class="w-full h-64 object-cover hover:scale-110 transition-all duration-500"
                width="800"
                height="450"
                loading={index === 0 ? "eager" : "lazy"}
              />
            </div>
          ))}
        </div>
      </div>

      <!-- Botón para unirse o ver servidor cerrado -->
      <div class="text-center mb-16 animate-fade-up animate-delay-300">
        {server.isActive ? (
          <a 
            href="#join-server" 
            id="join-button"
            class="inline-flex items-center gap-3 px-8 py-4 rounded-xl bg-primary/80 backdrop-blur-sm text-white font-bold text-xl shadow-glow border border-primary/50 transition-all duration-300 hover:shadow-lg hover:bg-primary hover:border-primary hover:-translate-y-1 animate-float"
          >
            <span>{t('join-now')}</span>
            <i class="fas fa-arrow-right"></i>
          </a>
        ) : (
          <div class="inline-flex items-center gap-3 px-8 py-4 rounded-xl bg-gray-700/80 backdrop-blur-sm text-white/80 font-bold text-xl border border-primary/30">
            <i class="fas fa-circle-info mr-2"></i>
            <span>{t('server-currently-closed')}</span>
          </div>
        )}
      </div>

      <!-- Instrucciones para unirse -->
      <div id="join-server" class="bg-black/30 backdrop-blur-md rounded-xl p-8 border border-primary/20 animate-fade-up animate-delay-400">
        <h2 class="text-2xl font-bold text-primary mb-6">{t('how-to-join-title')} {server.name}?</h2>
        
        <!-- Pasos para unirse -->
        <div class="flex flex-wrap justify-around mb-8">
          {server.modloader !== "Vanilla" ? (
            <>
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">1</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step1-title-modpack')}</h3>
                <p class="text-white/80">{t('step1-desc-modpack')}</p>
              </div>
              
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">2</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step2-title-modpack')}</h3>
                <p class="text-white/80">{t('step2-desc-modpack')}</p>
              </div>
              
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">3</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step3-title-modpack')}</h3>
                <p class="text-white/80">{t('step3-desc-modpack')} {server.name}!"</p>
              </div>
            </>
          ) : (
            <>
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">1</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step1-title-vanilla')}</h3>
                <p class="text-white/80">{t('step1-desc-vanilla')} {server.versions[0]}</p>
              </div>
              
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">2</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step2-title-vanilla')}</h3>
                <p class="text-white/80">{t('step2-desc-vanilla')}</p>
              </div>
              
              <div class="step text-center max-w-[250px] mb-8">
                <div class="step-number mx-auto w-12 h-12 rounded-full bg-primary/80 backdrop-blur-sm text-white flex items-center justify-center text-xl font-bold mb-4">3</div>
                <h3 class="font-bold text-primary text-lg mb-2">{t('step3-title-vanilla')}</h3>
                <p class="text-white/80">{t('step3-desc-vanilla')}</p>
              </div>
            </>
          )}
        </div>
        
        <!-- Instrucciones según el tipo de servidor -->
        {server.modloader === "Vanilla" ? (
          <div class="space-y-6">
            <div class="flex flex-col md:flex-row md:items-center gap-4 p-4 bg-black/40 backdrop-blur-sm rounded-lg">
              <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-full bg-primary/20 text-primary">
                <i class="fas fa-gamepad text-2xl"></i>
              </div>
              <div>
                <h3 class="text-lg font-bold text-primary mb-1">{t('minecraft-version-title')}</h3>
                <p>{t('minecraft-version-desc')} {server.versions[0]}</p>
              </div>
            </div>
            
            <div class="flex flex-col md:flex-row md:items-center gap-4 p-4 bg-black/40 backdrop-blur-sm rounded-lg">
              <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-full bg-primary/20 text-primary">
                <i class="fas fa-server text-2xl"></i>
              </div>
              <div>
                <h3 class="text-lg font-bold text-primary mb-1">{t('server-address-title')}</h3>
                <p class="mb-2">{t('server-address-desc')}</p>
                <div class="flex">
                  <code class="bg-black/60 backdrop-blur-sm p-2 rounded border border-primary/30 font-mono select-all">
                    {server.id}.luminakraft.com
                  </code>
                  <button class="copy-button ml-2 px-3 bg-primary/20 hover:bg-primary/40 transition-colors rounded border border-primary/30" data-text={`${server.id}.luminakraft.com`}>
                    <i class="fas fa-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        ) : (
          <div class="space-y-6">
            <div class="flex flex-col md:flex-row md:items-center gap-4 p-4 bg-black/40 backdrop-blur-sm rounded-lg">
              <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-full bg-primary/20 text-primary">
                <i class="fas fa-download text-2xl"></i>
              </div>
              <div>
                <h3 class="text-lg font-bold text-primary mb-1">{t('modpack-install-title')}</h3>
                <p class="mb-2">{t('modpack-install-desc')}</p>
                <div class="flex flex-wrap gap-3">
                  {!server.isActive ? (
                    <span class="px-4 py-2 bg-gray-700/80 backdrop-blur-sm text-gray-300 rounded-lg">
                      <del>{t('download-installer')}</del>
                    </span>
                  ) : (
                    <a
                      href="#"
                      class="px-4 py-2 bg-primary/90 backdrop-blur-sm hover:bg-primary text-white rounded-lg transition-colors inline-flex items-center gap-2"
                    >
                      <i class="fas fa-download"></i>
                      <span>{t('download-installer')}</span>
                    </a>
                  )}
                </div>
              </div>
            </div>
            
            <div class="flex flex-col md:flex-row md:items-center gap-4 p-4 bg-black/40 backdrop-blur-sm rounded-lg">
              <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-full bg-primary/20 text-primary">
                <i class="fas fa-info-circle text-2xl"></i>
              </div>
              <div>
                <h3 class="text-lg font-bold text-primary mb-1">{t('auto-connect-title')}</h3>
                <p>{t('auto-connect-desc')} {server.name}!" {t('inside-game')}</p>
              </div>
            </div>
          </div>
        )}
        
        <!-- Botón Discord -->
        <div class="text-center mt-10">
          <a 
            href="https://discord.gg/UJZRrcUFMj"
            target="_blank"
            rel="noopener"
            class="inline-flex items-center gap-3 px-6 py-3 rounded-lg bg-[#5865F2]/80 backdrop-blur-sm hover:bg-[#5865F2] text-white font-bold transition-all duration-300 hover:shadow-lg hover:-translate-y-1"
          >
            <i class="fab fa-discord"></i>
            <span>{t('join-discord')}</span>
          </a>
        </div>
      </div>
      
      <!-- Sección de Leaderboard para servidores que lo tengan -->
      {server.leaderboardPath && !server.isActive && (
        <div id="leaderboard-section" class="my-16 animate-fade-up animate-delay-500">
          <div class="bg-black/30 backdrop-blur-md rounded-xl p-8 border border-primary/20">
            <h2 class="text-2xl font-bold text-primary mb-6 flex items-center">
              <i class="fas fa-ranking-star mr-3"></i>
              {t('leaderboard-title')}
            </h2>
            <p class="text-white/80 mb-6">{t('leaderboard-description')}</p>
            
            <!-- Pagination controls -->
            <div class="flex flex-wrap justify-between items-center mb-6">
              <div class="flex items-center space-x-2">
                <label for="playersPerPage" class="text-white/80">Players per page:</label>
                <select id="playersPerPage" class="bg-black/40 backdrop-blur-sm text-white border border-primary/30 rounded px-2 py-1">
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </div>
              <div class="flex items-center space-x-2 mt-4 md:mt-0">
                <button id="prevPage" class="bg-black/40 backdrop-blur-sm text-white/80 border border-primary/30 rounded px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed">
                  <i class="fas fa-chevron-left mr-1"></i> Previous
                </button>
                <span id="pageIndicator" class="text-white/80">Page 1 of 1</span>
                <button id="nextPage" class="bg-black/40 backdrop-blur-sm text-white/80 border border-primary/30 rounded px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed">
                  Next <i class="fas fa-chevron-right ml-1"></i>
                </button>
              </div>
            </div>
            
            <div id="leaderboard" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
              <!-- Se llenará dinámicamente con JavaScript -->
              <div class="flex justify-center items-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
              </div>
            </div>
            
            <!-- Bottom pagination -->
            <div id="bottomPagination" class="flex justify-center mt-6">
              <div class="flex items-center space-x-2">
                <button id="prevPageBottom" class="bg-black/40 backdrop-blur-sm text-white/80 border border-primary/30 rounded px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed">
                  <i class="fas fa-chevron-left mr-1"></i> Previous
                </button>
                <span id="pageIndicatorBottom" class="text-white/80">Page 1 of 1</span>
                <button id="nextPageBottom" class="bg-black/40 backdrop-blur-sm text-white/80 border border-primary/30 rounded px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed">
                  Next <i class="fas fa-chevron-right ml-1"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  </div>
</BaseLayout>

<script define:vars={{ serverId: server.id, leaderboardPath: server.leaderboardPath, isActive: server.isActive }}>
  // Copiar al portapapeles
  document.addEventListener('DOMContentLoaded', function() {
    const copyButtons = document.querySelectorAll('.copy-button');
    
    copyButtons.forEach(button => {
      button.addEventListener('click', function() {
        const text = button.dataset.text || '';
        navigator.clipboard.writeText(text).then(() => {
          // Cambiar ícono temporalmente
          const icon = button.querySelector('i');
          if (icon) {
            icon.className = 'fas fa-check';
            setTimeout(() => {
              icon.className = 'fas fa-copy';
            }, 2000);
          }
        });
      });
    });
    
    // Cargar leaderboard si existe y el servidor está cerrado
    if (leaderboardPath && !isActive) {
      loadLeaderboard();
    }
  });
  
  // Pagination variables
  let leaderboardData = [];
  let currentPage = 1;
  let playersPerPage = 25;
  let totalPages = 1;
  
  // Función para cargar el leaderboard
  function loadLeaderboard() {
    fetch(leaderboardPath)
      .then(response => response.json())
      .then(data => {
        leaderboardData = data.Sheet1;
        
        // Ensure players per page is a multiple of columns count
        adjustPlayersPerPage();
        
        totalPages = Math.ceil(leaderboardData.length / playersPerPage);
        
        // Initialize pagination
        updatePageIndicators();
        updatePaginationButtons();
        renderLeaderboardPage();
        
        // Show bottom pagination controls if more than one page
        if (totalPages > 1) {
          document.getElementById('bottomPagination').classList.remove('hidden');
        }
        
        // Set up pagination events
        document.getElementById('prevPage').addEventListener('click', goToPreviousPage);
        document.getElementById('nextPage').addEventListener('click', goToNextPage);
        document.getElementById('prevPageBottom').addEventListener('click', goToPreviousPage);
        document.getElementById('nextPageBottom').addEventListener('click', goToNextPage);
        
        // Change players per page
        document.getElementById('playersPerPage').addEventListener('change', function() {
          playersPerPage = parseInt(this.value);
          // Ensure it's a multiple of columns count
          adjustPlayersPerPage();
          
          currentPage = 1;
          totalPages = Math.ceil(leaderboardData.length / playersPerPage);
          updatePageIndicators();
          updatePaginationButtons();
          renderLeaderboardPage();
          
          // Show or hide bottom pagination
          if (totalPages > 1) {
            document.getElementById('bottomPagination').classList.remove('hidden');
          } else {
            document.getElementById('bottomPagination').classList.add('hidden');
          }
        });
      })
      .catch(error => {
        console.error('Error loading leaderboard:', error);
        const leaderboardElement = document.getElementById('leaderboard');
        if (leaderboardElement) {
          leaderboardElement.innerHTML = `<div class="col-span-full text-center p-4 text-red-400"><i class="fas fa-exclamation-circle mr-2"></i>Error loading leaderboard</div>`;
        }
      });
  }
  
  // Function to adjust the number of players per page to a multiple of the columns count
  function adjustPlayersPerPage() {
    const columnsCount = window.innerWidth >= 1024 ? 5 : (window.innerWidth >= 768 ? 3 : (window.innerWidth >= 640 ? 2 : 1));
    
    // If not a multiple of columnsCount, round to the nearest multiple
    if (playersPerPage % columnsCount !== 0) {
      playersPerPage = Math.ceil(playersPerPage / columnsCount) * columnsCount;
      
      // Update the select element
      const selectElement = document.getElementById('playersPerPage');
      if (selectElement) {
        // Create new option if it doesn't exist
        let optionExists = false;
        for (let i = 0; i < selectElement.options.length; i++) {
          if (parseInt(selectElement.options[i].value) === playersPerPage) {
            selectElement.options[i].selected = true;
            optionExists = true;
            break;
          }
        }
        
        if (!optionExists) {
          const option = document.createElement('option');
          option.value = playersPerPage;
          option.text = playersPerPage;
          option.selected = true;
          selectElement.add(option);
        }
      }
    }
  }
  
  // Pagination functions
  function goToNextPage() {
    if (currentPage < totalPages) {
      currentPage++;
      updatePageIndicators();
      updatePaginationButtons();
      renderLeaderboardPage();
    }
  }
  
  function goToPreviousPage() {
    if (currentPage > 1) {
      currentPage--;
      updatePageIndicators();
      updatePaginationButtons();
      renderLeaderboardPage();
    }
  }
  
  function updatePageIndicators() {
    const pageIndicator = document.getElementById('pageIndicator');
    const pageIndicatorBottom = document.getElementById('pageIndicatorBottom');
    const pageText = `Page ${currentPage} of ${totalPages}`;
    
    if (pageIndicator) pageIndicator.textContent = pageText;
    if (pageIndicatorBottom) pageIndicatorBottom.textContent = pageText;
  }
  
  function updatePaginationButtons() {
    const prevButton = document.getElementById('prevPage');
    const nextButton = document.getElementById('nextPage');
    const prevButtonBottom = document.getElementById('prevPageBottom');
    const nextButtonBottom = document.getElementById('nextPageBottom');
    
    if (prevButton) prevButton.disabled = currentPage === 1;
    if (nextButton) nextButton.disabled = currentPage === totalPages;
    if (prevButtonBottom) prevButtonBottom.disabled = currentPage === 1;
    if (nextButtonBottom) nextButtonBottom.disabled = currentPage === totalPages;
  }
  
  function renderLeaderboardPage() {
    const start = (currentPage - 1) * playersPerPage;
    const end = Math.min(start + playersPerPage, leaderboardData.length);
    const playersToShow = leaderboardData.slice(start, end);
    
    let html = '';
    
    playersToShow.forEach((player, index) => {
      const rank = start + index + 1;
      const nombre = player.Usuario;
      const horas = player.Horas;
      const killsJugadores = player["Kills (jugadores)"];
      
      html += `
        <div class="player-card bg-black/40 backdrop-blur-sm p-4 rounded-lg text-center border border-primary/10 hover:border-primary/30 transition-all hover:transform hover:scale-105 cursor-pointer" data-expanded="false">
          <div class="rank text-xl font-bold text-primary">#${rank}</div>
          <div class="name mt-2">
            <img src="https://mc-heads.net/avatar/${nombre}/64" alt="${nombre}" class="w-16 h-16 rounded-lg mx-auto shadow-md" loading="lazy">
            <p class="mt-2 font-medium">${nombre}</p>
          </div>
          <div class="stats flex justify-center gap-4 mt-2">
            <div class="hours text-primary">
              <i class="fas fa-clock"></i> ${horas}h
            </div>
            <div class="kills text-primary">
              <i class="fas fa-sword-alt"></i> ${killsJugadores}
            </div>
          </div>
          <div class="player-details max-h-0 overflow-hidden opacity-0 transition-all duration-300 mt-0">
            <div class="border-t border-primary/20 my-3"></div>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <div><i class="fas fa-skull text-red-400"></i> ${player.Muertes}</div>
              <div><i class="fas fa-dragon text-green-400"></i> ${player["Kill (mobs)"]}</div>
              <div><i class="fas fa-heart-broken text-red-400"></i> ${player["Daño Recibido"]}</div>
              <div><i class="fas fa-fist-raised text-green-400"></i> ${player["Daño Causado"]}</div>
              <div><i class="fas fa-walking text-blue-400"></i> ${player["Caminado (km)"]}km</div>
              <div><i class="fas fa-swimming-pool text-blue-400"></i> ${player["Nadado (km)"]}km</div>
              <div colspan="2" class="text-center"><i class="fas fa-ship text-blue-400"></i> ${player["Barco (km)"]}km</div>
            </div>
          </div>
        </div>
      `;
    });
    
    const leaderboardElement = document.getElementById('leaderboard');
    if (leaderboardElement) {
      leaderboardElement.innerHTML = html;
      
      // Añadir eventos para expandir/colapsar detalles
      document.querySelectorAll('.player-card').forEach(card => {
        card.addEventListener('click', () => {
          const details = card.querySelector('.player-details');
          const isExpanded = card.getAttribute('data-expanded') === 'true';
          
          if (isExpanded) {
            // Colapsar
            details.classList.remove('max-h-60', 'opacity-100', 'mt-3');
            details.classList.add('max-h-0', 'opacity-0', 'mt-0');
            card.setAttribute('data-expanded', 'false');
          } else {
            // Expandir
            details.classList.remove('max-h-0', 'opacity-0', 'mt-0');
            details.classList.add('max-h-60', 'opacity-100', 'mt-3');
            card.setAttribute('data-expanded', 'true');
          }
        });
      });
    }
  }
</script> 